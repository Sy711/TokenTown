(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[506],{6425:(e,t,a)=>{Promise.resolve().then(a.bind(a,8277))},8277:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var s=a(7437),r=a(2265),n=a(7138),l=a(2231);let c=(0,a(8030).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var d=a(1240),i=a(690),u=a(6013),o=a(5417),m=a(6078);function f(){let[e,t]=(0,r.useState)(!0),[a,f]=(0,r.useState)(0),[x,p]=(0,r.useState)([]),v=(0,l.t)(),[h,b]=(0,r.useState)("");return(0,o.J4)().then(e=>{f(null!=e?e:0)}),(0,r.useEffect)(()=>{try{(0,o.XH)().then(e=>{p(e)}),console.log(x),(0,o.J4)().then(e=>{f(null!=e?e:0)}),(0,o.cv)().then(e=>{b(null!=e?e:"")})}catch(e){console.error("Error fetching vault data:",e),console.log(e)}}),(0,r.useEffect)(()=>{setTimeout(()=>{t(!1)},1e3)},[]),(0,s.jsxs)("div",{className:"min-h-screen w-full bg-gradient-to-br from-[#1a1a2e] to-[#16213e] p-4",children:[(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between rounded-lg bg-black/30 p-3 backdrop-blur-sm",children:[(0,s.jsxs)(n.default,{href:"/",className:"flex items-center gap-2 text-white",children:[(0,s.jsx)(c,{size:18}),(0,s.jsx)("span",{className:"font-medium",children:"返回"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.Z,{size:18,className:"text-blue-400"}),(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:"限制名额: 5名"})]})]}),(0,s.jsxs)("div",{className:"mx-auto max-w-2xl",children:[(0,s.jsxs)("div",{className:"mb-6 text-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-white",children:"TokenTown 排行榜"}),(0,s.jsxs)("p",{className:"mt-1 text-gray-300",children:["当前金库总额:",a," SUI"]})]}),(0,s.jsxs)(u.Zb,{className:"w-full bg-black/20 p-4 mt-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-4 text-center",children:"今日排行"}),e?(0,s.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,s.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-4 rounded-lg bg-blue-900/20 p-3",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.Z,{size:16,className:"text-blue-400"}),(0,s.jsx)("span",{className:"text-sm text-gray-300",children:"仅限前5名玩家参与游戏"})]})})}),(0,s.jsxs)("div",{className:"rounded-lg bg-black/40 p-4",children:[(0,s.jsxs)("div",{className:"mb-3 grid grid-cols-12 text-xs font-medium text-white",children:[(0,s.jsx)("div",{className:"col-span-1",children:"排名"}),(0,s.jsx)("div",{className:"col-span-4",children:"玩家"}),(0,s.jsx)("div",{className:"col-span-3",children:"卡牌数"})]}),(0,s.jsx)("div",{className:"space-y-2",children:x.map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-12 items-center rounded py-2 text-sm ".concat(v&&e.player===v.address?"bg-blue-900/30":""),children:[(0,s.jsx)("div",{className:"col-span-1 font-bold text-white",children:t+1}),(0,s.jsxs)("div",{className:"col-span-4 flex items-center gap-1 text-white",children:[(0,m.T)(e.player),h&&e.player===h&&(0,s.jsx)("span",{className:"rounded bg-purple-500/30 px-1 py-0.5 text-xs text-purple-300",children:"首位提交"})]}),(0,s.jsxs)("div",{className:"col-span-3 text-white",children:[e.card_count,"张"]})]},e.player+"-"+t))})]})]})]})]})]})}function x(){return(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)("div",{className:"flex h-screen w-full items-center justify-center",children:"加载中..."}),children:(0,s.jsx)(f,{})})}},6013:(e,t,a)=>{"use strict";a.d(t,{Zb:()=>l});var s=a(7437),r=a(2265),n=a(7440);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});l.displayName="Card",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...r})}).displayName="CardHeader",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})}).displayName="CardTitle",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})}).displayName="CardDescription",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...r})}).displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},2267:(e,t,a)=>{"use strict";a.d(t,{Hi:()=>o,L5:()=>d,$:()=>i,vd:()=>m});var s=a(729),r=a(2788),n=a(2231),l=a(6047);let c={testnet:{Package:"0xaaa6f50dee638bb6056f137fe2336f1dc03b0fc5a38f2ddce014b72bfaea89d7",Vault:"0xecc00b51af1cc0da48d54488428502bf80a33df18182352fb4e0d64617448e89"},mainnet:{Package:"0x1111111111111111111111111111111111111111"}},d="testnet",{networkConfig:i,useNetworkVariables:u}=(0,n.mB)({testnet:{url:(0,s.I)("testnet"),variables:c.testnet},mainnet:{url:(0,s.I)("mainnet"),variables:c.mainnet}});function o(e){return t=>e(new l.Y,i[d].variables,t)}let m=new r.u({url:i[d].url})},5417:(e,t,a)=>{"use strict";a.d(t,{J4:()=>l,OQ:()=>o,RS:()=>u,XH:()=>c,cv:()=>d,zB:()=>i});var s=a(2267),r=a(2737),n=a.n(r);let l=async()=>{let e="".concat(s.$.testnet.variables.Package,"::card::PaymentEvent"),t=n()().startOf("day").unix(),a=n()().endOf("day").unix();for(let r of(await s.vd.queryEvents({query:{MoveEventType:e},limit:1,order:"descending"})).data){let e=Math.floor(Number(r.timestampMs)/1e3);if(e>=t&&e<=a)return r.parsedJson.amount/1e9}return 0},c=async()=>{let e="".concat(s.$.testnet.variables.Package,"::card::DailyLeaderboardEvent"),t=n()().startOf("day").unix(),a=n()().endOf("day").unix(),r=await s.vd.queryEvents({query:{MoveEventType:e},limit:100}),l=new Map;for(let e of r.data){let s=e.parsedJson,r=Math.floor(Number(e.timestampMs)/1e3);if(r>=t&&r<=a){let e=l.get(s.player);(!e||BigInt(s.card_count)>BigInt(e.card_count))&&l.set(s.player,s)}}return Array.from(l.values()).sort((e,t)=>Number(BigInt(t.card_count)-BigInt(e.card_count)))},d=async()=>{let e="".concat(s.$.testnet.variables.Package,"::card::FirstEvent"),t=n()().startOf("day").unix(),a=n()().endOf("day").unix();for(let r of(await s.vd.queryEvents({query:{MoveEventType:e},limit:1,order:"descending"})).data){let e=Math.floor(Number(r.timestampMs)/1e3);if(e>=t&&e<=a)return r.parsedJson.player}return null},i=async()=>{let e="".concat(s.$.testnet.variables.Package,"::card::IncentiveSubmitEvent"),t=n()().startOf("day").unix(),a=n()().endOf("day").unix();for(let r of(await s.vd.queryEvents({query:{MoveEventType:e},limit:1,order:"descending"})).data){let e=Math.floor(Number(r.timestampMs)/1e3);if(e>=t&&e<=a)return r.parsedJson}return null},u=(0,s.Hi)((e,t,a)=>{if(a.wallet)e.moveCall({target:"".concat(t.Package,"::card::payment"),arguments:[e.object(a.wallet),e.object(t.Vault)]});else{let[a]=e.splitCoins(e.gas,[e.pure.u64(2e8)]);e.moveCall({package:t.Package,module:"card",function:"payment",arguments:[a,e.object(t.Vault)]})}return e}),o=(0,s.Hi)((e,t,a)=>(e.moveCall({package:t.Package,module:"card",function:"submit",arguments:[e.pure.u64(Number(a.cardCount)),e.pure.u64(Number(a.time)),e.object(t.Vault)]}),e))},7440:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var s=a(4839),r=a(6164);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}},1240:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(8030).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},6078:(e,t,a)=>{"use strict";function s(e){if(e.length<=6)return e;let t=e.startsWith("0x")?2:0;return`0x${e.slice(t,t+4)}\u2026${e.slice(-4)}`}a.d(t,{T:()=>s})}},e=>{var t=t=>e(e.s=t);e.O(0,[279,108,130,215,744],()=>t(6425)),_N_E=e.O()}]);